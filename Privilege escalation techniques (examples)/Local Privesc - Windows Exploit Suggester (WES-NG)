==============================================================================================
Windows local privilege escalation check using the tool Windows Exploit Suggester 'WES-NG'
==============================================================================================

> WES-NG is a tool that determine the list of missing security patches of a Windows machine based on the output of command 'systeminfo'.
> It can list the vulnerabilities based on their severity and the existence of a public exploit.
> Every Windows OS between Windows XP and Windows 11, including their Windows Server counterparts, is supported.

----------------------------------------------------------------------------------------------
Step 1 - Download the tool Windows Exploit Suggester (NG)
----------------------------------------------------------------------------------------------

> https://github.com/bitsadmin/wesng/

----------------------------------------------------------------------------------------------
Step 2 - Update the patch defintions 
----------------------------------------------------------------------------------------------

C:\Users\Administrator\Documents\Tools-Pentest\Win-Exploit-Suggester> python3 wes.py --update
Windows Exploit Suggester 1.03 ( https://github.com/bitsadmin/wesng/ )
[+] Updating definitions
[+] Obtained definitions created at 20221227

----------------------------------------------------------------------------------------------
Step 3 - List the patches installed on the Windows machines that we want to audit
----------------------------------------------------------------------------------------------

Execute the command 'systeminfo' on the Windows machines that we want to check for missing security patches.

C:\> systeminfo > hostname_systeminfo.txt

C:\> systeminfo /S

----------------------------------------------------------------------------------------------
Step 4 - Identify the list of missing security patches and potential exploits  
----------------------------------------------------------------------------------------------

Several commands can be used:

> List only vulnerabilities with exploits, excluding IE, Edge and Flash:
  C:\> wes.py systeminfo.txt --exploits-only --hide "Internet Explorer" Edge Flash
  C:\> wes.py systeminfo.txt -e --hide "Internet Explorer" Edge Flash

> Only show vulnerabilities of a certain impact:
  C:\> wes.py systeminfo.txt --impact "Remote Code Execution"
  C:\> wes.py systeminfo.txt -i "Remote Code Execution"
  
> Only show vulnerabilities of a certain severity:
  C:\> wes.py systeminfo.txt --severity critical

> Determine vulnerabilies by filtering out vulnerabilities of KBs that have been published before the publishing date of the most recent KB installed
  C:\> wes.py systeminfo.txt --usekbdate
  C:\> wes.py systeminfo.txt -d


In the example below (Winndows server 2016), the setting '--usekbdate' is used to reduce the number of false postives.
   
C:\Users\Administrator\Documents\Tools-Pentest\Win-Exploit-Suggester> python3 wes.py Windowsserver2016Systeminfo.txt --usekbdate
Windows Exploit Suggester 1.03 ( https://github.com/bitsadmin/wesng/ )
[+] Parsing systeminfo output
[+] Operating System
    - Name: Windows Server 2016
    - Generation: 2016
    - Build: 14393
    - Version: 1607
    - Architecture: x64-based
    - Installed hotfixes (4): KB3192137, KB3211320, KB5017396, KB4103723
[+] Loading definitions
    - Creation date of definitions: 20221227
[+] Determining missing patches
[+] Filtering old vulnerabilities
    - Most recent KB installed is KB5020873 released at 20221219
    - Filtering all KBs released before this date
[+] Filtering duplicate vulnerabilities
[!] Found vulnerabilities!

Date: 20221219
CVE: CVE-2022-41089
KB: KB5020873
Title: .NET Framework Remote Code Execution Vulnerability
Affected product: Microsoft .NET Framework 4.8 on Windows Server 2016
Affected component: Microsoft
Severity: Important
Impact: Remote Code Execution
Exploit: n/a

Date: 20221219
CVE: CVE-2022-41089
KB: KB5020880
Title: .NET Framework Remote Code Execution Vulnerability
Affected product: Microsoft .NET Framework 4.8 on Windows Server 2016
Affected component: Microsoft
Severity: Important
Impact: Remote Code Execution
Exploit: n/a

Date: 20221219
CVE: CVE-2022-41089
KB: KB5020880
Title: .NET Framework Remote Code Execution Vulnerability
Affected product: Microsoft .NET Framework 4.8 on Windows Server 2016
Affected component: Microsoft
Severity: Important
Impact: Remote Code Execution
Exploit: n/a

Date: 20221219
CVE: CVE-2022-41089
KB: KB5020880
Title: .NET Framework Remote Code Execution Vulnerability
Affected product: Microsoft .NET Framework 4.8 on Windows Server 2016
Affected component: Microsoft
Severity: Important
Impact: Remote Code Execution
Exploit: n/a

Date: 20221219
CVE: CVE-2022-41089
KB: KB5020880
Title: .NET Framework Remote Code Execution Vulnerability
Affected product: Microsoft .NET Framework 4.8 on Windows Server 2016
Affected component: Microsoft
Severity: Important
Impact: Remote Code Execution
Exploit: n/a

[-] Missing patches: 2
    - KB5020880: patches 4 vulnerabilities
    - KB5020873: patches 1 vulnerability
[I] KB with the most recent release date
    - ID: KB5020873
    - Release date: 20221219
[+] Done. Displaying 5 of the 5 vulnerabilities found.

